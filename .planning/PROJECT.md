# Evan's Story Studio

## What This Is

A magical bedtime story generator PWA built for iPad. A child (or parent) picks a hero, a world, and a villain from beautifully illustrated cards, chooses an art style, and gets a unique 5-page illustrated bedtime story generated by AI. The story can be read as a swipeable picture book or exported as a cinematic video with Ken Burns effects and lullaby music. Built for Evan (age ~4), but designed with product potential in mind.

## Core Value

A child taps three cards and gets a beautiful, personalized bedtime story with illustrations — the full magic loop from pick to read must feel seamless and delightful.

## Requirements

### Validated

(None yet — ship to validate)

### Active

- [ ] Character picker with heroes, worlds, and villains as large tactile cards
- [ ] Real Character Mode — upload Evan's photo for face-consistent hero illustrations
- [ ] Fiction Character Mode — pick from curated child-friendly characters (Bluey, Elsa, Pikachu, etc.)
- [ ] 6 graphic styles (watercolor, 3D cartoon, anime, comic, paper cut, chalk) with prompt prefixes
- [ ] AI story generation via Claude API — 5-page stories with adaptive reading level
- [ ] AI illustration generation via fal.ai — style-prefixed, character-consistent across all pages
- [ ] Face-consistent generation using fal.ai PuLID when reference photo is provided
- [ ] Swipeable story reader with full-bleed illustrations and frosted glass text overlay
- [ ] Remotion video composition with title card, Ken Burns scenes, and end card
- [ ] Video preview via Remotion Player embed
- [ ] Progressive loading — text appears immediately, images generate one by one
- [ ] Persistent state — story, style preference, and reference photo saved to localStorage
- [ ] PWA — installable on iPad home screen, landscape-optimized standalone mode
- [ ] Dark starry night aesthetic with animated particles, gold/purple accents, frosted glass
- [ ] Graceful error handling — gradient placeholders for failed images, retry for story failures

### Out of Scope

- Phone/mobile responsive layouts — iPad landscape only for v1
- Cloud rendering / video export download — v1 uses Remotion Player preview only (bundler doesn't work in Next.js)
- User accounts / auth — local device only
- Multiple children profiles — Evan only for v1
- Text-to-speech / audio narration — lullaby background only
- Real-time collaboration or sharing
- Backend database — all state in localStorage

## Context

- The instruction document was generated by Claude Desktop — it's detailed but needs critical review on tech choices
- The project was previously attempted (per memory: Next.js 16, Remotion v4, fal.ai PuLID confirmed working) but this is a fresh start with proper planning
- Evan is approximately 4 years old — stories should have adaptive reading level (simpler for younger, richer for older)
- The parent wants this to feel like a polished product, not an AI prototype — UI quality is a top priority
- API keys for both Anthropic and fal.ai are already set up and ready
- fal.ai PuLID model (`fal-ai/flux-pulid`) confirmed working for face-consistent generation with `prompt` + `reference_image_url`
- `@remotion/bundler` does NOT work inside Next.js — use `@remotion/lambda` for future export, `<Player>` for v1 preview

## Constraints

- **Platform**: iPad landscape only (1024x768+ viewport) — no phone breakpoints
- **Tech stack**: Next.js 16+ (Turbopack), TypeScript strict, Tailwind CSS v4, React 19
- **AI services**: Claude API (`claude-sonnet-4-5`) for stories, fal.ai (`flux/schnell` + `flux-pulid`) for images
- **State management**: Zustand v5 with localStorage persistence
- **PWA**: `@serwist/next` (not the abandoned `next-pwa`)
- **Animation**: Framer Motion (`motion/react` package) — also handles swipe gestures, no extra gesture library
- **Video**: Remotion v4+ — Player preview only in v1 (no server-side export)
- **UI quality**: Use Aceternity UI / Magic UI patterns for polished animated components — avoid generic AI-looking layouts
- **Bundle size**: Remotion is heavy — use dynamic imports
- **No inline styles**: Tailwind classes only, except dynamic values

## Key Decisions

| Decision | Rationale | Outcome |
|----------|-----------|---------|
| Zustand over Jotai | Simpler API, better localStorage integration, less boilerplate | — Pending |
| `@serwist/next` over `next-pwa` | `next-pwa` is abandoned, Serwist works with Turbopack | — Pending |
| PuLID for face reference | Confirmed working with fal.ai, 90%+ facial feature preservation | — Pending |
| Player-only video (no export) | `@remotion/bundler` breaks in Next.js, lambda setup is v2 scope | — Pending |
| Framer Motion for gestures | Already installed for animations, built-in drag/swipe API | — Pending |
| iPad-only viewport | Target user is Evan on iPad, no phone complexity for v1 | — Pending |
| Adaptive reading level | More useful than hardcoded 2-5 range, adds minimal complexity | — Pending |
| Aceternity/Magic UI patterns | Copy-paste animated Tailwind components for polished, non-AI-looking UI | — Pending |

---
*Last updated: 2026-02-19 after initialization*
